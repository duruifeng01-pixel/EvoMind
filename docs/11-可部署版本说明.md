# 11 可部署版本说明（当前实现）

> 本次已从“纯文档”推进到“可运行后端 + 可构建安卓工程骨架 + 核心业务接口闭环样例”。

## 1. 已实现内容

- 后端可运行服务（Spring Boot）
  - 健康检查：`GET /api/v1/health`
  - 认证扩展接口：`POST /api/v1/auth/sms/send`、`POST /api/v1/auth/sms/login`、`POST /api/v1/auth/password/login`、`POST /api/v1/auth/wechat/login`、`POST /api/v1/auth/password/reset`、`POST /api/v1/auth/logout`
  - 新手引导：`GET /api/v1/onboarding/state`、`POST /api/v1/onboarding/complete`
  - 信息源：`POST /api/v1/sources/ocr/recognize`、`POST /api/v1/sources/import`、`POST /api/v1/sources/manual`、`GET /api/v1/sources`、`DELETE /api/v1/sources/{id}`
  - 认知卡片：`GET /api/v1/cards/feed`、`GET /api/v1/cards/{id}/mindmap`、`GET /api/v1/cards/{id}/drilldown`
  - 内化讨论：`POST /api/v1/discussion/daily-question/generate`、`POST /api/v1/discussion/{id}/reply`、`POST /api/v1/discussion/{id}/finalize`
  - 挑战任务：`GET /api/v1/challenges/current`、`POST /api/v1/challenges/{id}/status`
  - 订阅支付：`GET /api/v1/subscription/plans`、`POST /api/v1/subscription/cost-estimate`、`POST /api/v1/orders/create`、`GET /api/v1/orders/history`、`POST /api/v1/refund/apply`、`POST /api/v1/pay/wechat/callback`、`POST /api/v1/pay/alipay/callback`
  - 隐私权利：`POST /api/v1/privacy/export`、`POST /api/v1/privacy/delete-account`
- 订阅计费公式已代码化：
  - `订阅费 = 向上取整(实时算力成本) × 2`
- 安卓工程骨架（Android Studio 可打开）
  - 五大 Tab：首页/信息源/语料库/小组/我的
  - 全中文 UI 文案
  - 高级感渐变背景与卡片样式
- Docker 部署链路
  - 后端镜像可由源码构建
  - compose 一键拉起 mysql/redis/api

## 2. 运行方式

### 2.1 本地运行后端

```bash
cd backend
mvn spring-boot:run
```

### 2.2 Docker 运行后端

```bash
cd deploy
docker compose up --build
```

## 3. 安卓构建方式

```bash
cd android-app
./gradlew assembleDebug
```

> 说明：当前环境未内置 Android SDK，仓库内已提供可导入 Android Studio 的工程结构。

## 4. 距离“可上线发行完整版本”仍需完成

- 将内存存储替换为 MySQL/Redis 持久化仓储
- 实际支付 SDK（微信/支付宝）联调与回调验签落库
- OCR / 语音 SDK / 国内大模型 API 接入
- 完整业务页面与数据库读写（目前为骨架与接口样例）
- 完整自动化测试报告与各应用市场上架材料


## 5. Maven 依赖下载（方案A：国内镜像）

仓库已内置 Maven 镜像配置：`backend/.mvn/settings.xml`（阿里云公共仓库镜像）。

可直接执行：

```bash
cd backend
./run-tests-with-mirror.sh
```

或手动指定：

```bash
mvn -s backend/.mvn/settings.xml -f backend/pom.xml test
```
