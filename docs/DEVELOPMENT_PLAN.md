# EvoMind 开发方案

## 一、开发原则

### 1.1 核心原则
- **MVP优先**：先实现最小可用版本，再逐步迭代
- **本地优先**：核心功能必须离线可用
- **渐进增强**：从简单到复杂，逐步添加功能
- **风险前置**：技术难点提前验证（AIGC集成、支付、OCR）

### 1.2 技术债务控制
- 每个阶段完成后进行代码审查
- 保持架构一致性，避免后期重构成本
- 关键模块必须有单元测试覆盖

---

## 二、开发阶段划分（6个阶段）

### 阶段0：基础设施搭建（1-2周）
**目标**：搭建开发环境、依赖配置、基础架构

#### 任务清单
1. **依赖管理**
   - [ ] 配置 Hilt (依赖注入)
   - [ ] 配置 Room (本地数据库)
   - [ ] 配置 Retrofit + OkHttp (网络层)
   - [ ] 配置 Coil (图片加载)
   - [ ] 配置 Navigation Compose (页面导航)
   - [ ] 配置 DataStore (本地配置存储)

2. **基础架构**
   - [ ] 搭建 Clean Architecture 基础结构
   - [ ] 配置 Hilt Modules (AppModule, DataModule, NetworkModule)
   - [ ] 创建 BaseViewModel、BaseRepository 基类
   - [ ] 配置错误处理机制 (Result<T> 封装)
   - [ ] 配置日志系统 (Timber)

3. **UI基础**
   - [ ] 完善 Theme 系统 (Color, Typography, Material3)
   - [ ] 创建基础组件库 (Button, Card, Loading, ErrorState)
   - [ ] 配置深色模式支持

4. **工具类**
   - [ ] CryptoUtils (AES加密，用于本地数据加密)
   - [ ] CostCalculator (算力成本计算)
   - [ ] DateUtils, StringUtils 等通用工具

**验收标准**：
- 项目可以编译运行
- 依赖注入正常工作
- 基础UI组件可预览

---

### 阶段1：用户体系 + 本地数据库（2-3周）
**目标**：完成用户注册/登录，建立本地数据存储基础

#### 1.1 数据库设计
- [ ] 设计 Room Entity：
  - UserEntity (用户信息)
  - CorpusEntity (语料库)
  - CognitiveCardEntity (认知卡片)
  - TaskEntity (挑战任务)
  - CostRecordEntity (算力成本记录)
- [ ] 创建 DAO 接口
- [ ] 创建 Database 类（加密配置）
- [ ] 数据库迁移策略

#### 1.2 用户体系
- [ ] 注册页面 (手机号验证码)
- [ ] 登录页面 (手机号/密码/微信)
- [ ] 个人中心页面
- [ ] 设置页面
- [ ] ViewModel + UseCase 实现
- [ ] Repository 实现（本地优先）

#### 1.3 数据同步基础
- [ ] 设计数据同步策略（本地→云端）
- [ ] 实现基础网络接口（Retrofit Service）
- [ ] 实现 Repository 的本地+远程逻辑

**验收标准**：
- 用户可以注册/登录
- 用户数据本地存储正常
- 个人中心可查看基础信息

---

### 阶段2：信息源导入（2-3周）
**目标**：实现信息源导入功能（核心输入模块）

#### 2.1 OCR截图识别
- [ ] 集成国内OCR SDK (百度/阿里云)
- [ ] 实现截图选择功能
- [ ] 实现OCR识别逻辑
- [ ] 实现博主列表选择UI
- [ ] 错误处理和重试机制

#### 2.2 平台绑定导入
- [ ] 设计平台授权流程（微信/小红书/知乎/微博）
- [ ] 实现平台SDK集成（仅获取关注列表）
- [ ] 实现博主选择UI
- [ ] 实现信息源管理页面

#### 2.3 手动导入
- [ ] 实现链接输入UI
- [ ] 实现链接验证逻辑
- [ ] 实现批量导入功能

#### 2.4 信息源管理
- [ ] 信息源列表展示
- [ ] 删除/分组/置顶功能
- [ ] 信息源更新推送机制

**验收标准**：
- 可以通过截图识别导入信息源
- 可以手动添加信息源
- 信息源管理功能正常

---

### 阶段3：认知模块（3-4周）
**目标**：实现认知卡片和脑图功能

#### 3.1 AIGC模型集成（技术验证）
- [ ] 选择并集成国内AIGC模型（Moonshot/Kimi/Qwen）
- [ ] 实现模型路由策略（轻量/高性能）
- [ ] 实现Token计算和成本记录
- [ ] 实现内容合规检查

#### 3.2 认知卡片
- [ ] 实现内容抓取逻辑（仅链接+摘要，不存全文）
- [ ] 实现AI生成一句话导读
- [ ] 实现卡片列表UI（左右滑动）
- [ ] 实现卡片详情页
- [ ] 实现7:3混合信息流算法

#### 3.3 脑图功能
- [ ] 实现AI生成脑图逻辑
- [ ] 实现脑图UI组件（可缩放、展开/折叠）
- [ ] 实现下钻式原文查看
- [ ] 实现观点冲突检测（付费功能标记）

#### 3.4 推送系统
- [ ] 实现每日推送逻辑
- [ ] 实现通知栏提醒
- [ ] 实现推送设置

**验收标准**：
- 认知卡片可以正常展示
- 脑图可以生成和交互
- AI内容生成正常，成本记录准确

---

### 阶段4：内化模块（3-4周）
**目标**：实现每日一问、语料库、私有Agent

#### 4.1 每日一问
- [ ] 实现问题生成逻辑（基于认知卡片）
- [ ] 实现讨论UI（文字/语音输入）
- [ ] 集成语音识别SDK（科大讯飞）
- [ ] 实现AI追问/反驳逻辑
- [ ] 实现讨论总结生成

#### 4.2 语料库
- [ ] 实现语料库存储（本地Room）
- [ ] 实现语料库管理UI（搜索、筛选、导出）
- [ ] 实现关键词云生成
- [ ] 实现知识半衰期提醒

#### 4.3 私有Agent训练
- [ ] 实现本地轻量模型集成（可选：端侧推理）
- [ ] 实现Agent训练逻辑
- [ ] 实现Agent对话UI
- [ ] 实现Agent优化/重置功能

**验收标准**：
- 每日一问功能完整
- 语料库可以正常管理
- Agent可以训练和使用（或至少框架搭建完成）

---

### 阶段5：行动模块 + 支付体系（3-4周）
**目标**：实现挑战任务和支付功能

#### 5.1 挑战任务系统
- [ ] 实现任务生成逻辑（基于进化计划）
- [ ] 实现变步频梯度规则
- [ ] 实现任务UI（列表、详情、完成）
- [ ] 实现作品上传功能
- [ ] 实现解锁式激励机制

#### 5.2 支付体系
- [ ] 集成微信支付SDK
- [ ] 集成支付宝SDK
- [ ] 实现套餐选择UI
- [ ] 实现支付流程
- [ ] 实现订阅管理
- [ ] 实现算力成本展示

#### 5.3 算力成本系统
- [ ] 完善CostCalculator（实时计算）
- [ ] 实现成本统计UI
- [ ] 实现订阅费计算逻辑
- [ ] 实现点餐式订阅模式

**验收标准**：
- 挑战任务可以生成和完成
- 支付流程完整可用
- 算力成本计算准确

---

### 阶段6：反馈模块 + 优化（2-3周）
**目标**：完成分享功能和整体优化

#### 6.1 分享功能
- [ ] 实现分享图生成（脑图/关键词云/能力报告）
- [ ] 实现多平台尺寸适配
- [ ] 集成分享SDK（微信/小红书/知乎）

#### 6.2 互助小组
- [ ] 实现小组创建/加入
- [ ] 实现匿名讨论功能
- [ ] 实现精华汇总

#### 6.3 新手引导
- [ ] 实现分步式蒙层引导
- [ ] 实现引导福利发放

#### 6.4 性能优化
- [ ] 启动时间优化（≤3秒）
- [ ] 内存优化（≤500MB）
- [ ] 网络请求优化
- [ ] 图片加载优化

#### 6.5 测试与合规
- [ ] 功能测试
- [ ] 兼容性测试（主流机型）
- [ ] 安全测试
- [ ] AIGC内容合规测试
- [ ] 隐私政策/用户协议

**验收标准**：
- 所有核心功能完整
- 性能指标达标
- 通过合规检查

---

## 三、技术选型确认

### 3.1 已确定
- **UI**: Jetpack Compose + Material3
- **架构**: Clean Architecture + MVVM
- **DI**: Hilt
- **数据库**: Room (加密)
- **网络**: Retrofit + OkHttp
- **图片**: Coil

### 3.2 待选型（需提前验证）
- **AIGC模型**: Moonshot / Kimi / Qwen（需对比API稳定性、成本、响应速度）
- **OCR**: 百度OCR / 阿里云OCR（需对比识别准确率、价格）
- **语音识别**: 科大讯飞（已确定，但需验证集成难度）
- **本地模型**: 端侧推理方案（可选，需评估设备性能要求）

---

## 四、风险控制策略

### 4.1 技术风险
| 风险 | 影响 | 应对策略 |
|------|------|----------|
| AIGC API不稳定 | 高 | 阶段3提前验证，准备备选方案 |
| OCR识别准确率低 | 中 | 阶段2提前测试，提供手动补充入口 |
| 支付SDK集成复杂 | 中 | 阶段5提前验证，准备测试环境 |
| 本地模型性能不足 | 低 | Agent功能可降级为云端调用 |

### 4.2 业务风险
| 风险 | 影响 | 应对策略 |
|------|------|----------|
| 算力成本计算不准确 | 高 | 阶段0建立完善的成本计算框架 |
| 内容合规审核遗漏 | 高 | 阶段3集成合规接口，建立审核流程 |
| 用户数据隐私泄露 | 高 | 阶段1实现加密存储，阶段6安全测试 |

### 4.3 进度风险
- **缓冲时间**：每个阶段预留20%缓冲时间
- **并行开发**：UI和业务逻辑可并行（UI用Mock数据）
- **MVP原则**：核心功能优先，次要功能可延后

---

## 五、开发流程建议

### 5.1 每日流程
1. **晨会**（15分钟）：同步进度、识别阻塞
2. **开发**：按任务清单推进
3. **代码审查**：关键功能提交前必须Review
4. **每日构建**：确保主分支可编译运行

### 5.2 每周流程
1. **周会**：总结进度、调整计划
2. **Demo**：演示本周完成功能
3. **技术分享**：分享遇到的难点和解决方案

### 5.3 阶段流程
1. **阶段开始**：技术方案评审、任务拆分
2. **阶段中**：每日进度跟踪、风险识别
3. **阶段结束**：功能验收、代码审查、文档更新

---

## 六、里程碑设置

### M1: 基础设施完成（阶段0结束）
- 可以开始业务功能开发

### M2: 用户体系可用（阶段1结束）
- 用户可以注册登录，数据本地存储

### M3: 信息源导入可用（阶段2结束）
- 核心输入功能完成

### M4: 认知模块MVP（阶段3结束）
- 认知卡片和脑图基本可用

### M5: 内化模块MVP（阶段4结束）
- 每日一问和语料库可用

### M6: 支付体系完成（阶段5结束）
- 商业化功能就绪

### M7: 产品上线就绪（阶段6结束）
- 所有功能完成，通过测试

---

## 七、关键决策点

### 7.1 阶段0结束时
- [ ] 确认AIGC模型选型（Moonshot/Kimi/Qwen）
- [ ] 确认OCR服务选型
- [ ] 确认后端API设计（如果需要）

### 7.2 阶段3开始时
- [ ] 确认AIGC API稳定性
- [ ] 确认内容合规方案
- [ ] 确认成本计算准确性

### 7.3 阶段5开始时
- [ ] 确认支付SDK集成方案
- [ ] 确认订阅计费逻辑
- [ ] 确认退款流程

---

## 八、开发工具推荐

### 8.1 必需工具
- **IDE**: Android Studio (最新稳定版)
- **版本控制**: Git + GitHub/Gitee
- **项目管理**: 任务清单（可用GitHub Issues或Notion）

### 8.2 推荐工具
- **API测试**: Postman / Insomnia
- **数据库查看**: Room Database Inspector
- **性能分析**: Android Profiler
- **UI设计**: Figma（设计稿）

---

## 九、团队协作建议（如有多人）

### 9.1 分工建议
- **架构师**：负责阶段0、架构设计、技术选型
- **后端开发**：负责API设计、数据同步逻辑
- **前端开发**：负责UI实现、用户体验优化
- **测试**：负责测试用例、兼容性测试

### 9.2 代码规范
- 遵循 Kotlin 官方编码规范
- 使用 ktlint 进行代码格式化
- 关键函数必须有中文注释
- 提交信息使用中文，格式：`[模块] 功能描述`

---

## 十、总结

### 10.1 开发周期预估
- **总时长**: 16-22周（4-5.5个月）
- **MVP版本**: 12-16周（3-4个月，不含阶段6部分功能）

### 10.2 关键成功因素
1. **技术验证前置**：AIGC、OCR、支付提前验证
2. **本地优先**：确保核心功能离线可用
3. **成本透明**：算力成本计算必须准确
4. **合规优先**：内容审核、隐私保护不能有漏洞

### 10.3 下一步行动
1. 立即开始阶段0：配置依赖、搭建基础架构
2. 并行进行技术选型调研（AIGC、OCR）
3. 设计数据库Schema（阶段1前置工作）

---

**文档版本**: v1.0  
**创建日期**: 2026-02-13  
**最后更新**: 2026-02-13
